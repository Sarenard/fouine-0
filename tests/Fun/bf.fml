(*done by a LLM for testing purposes*)
let fix = fun f -> (fun x -> f (fun v -> x x v)) (fun x -> f (fun v -> x x v)) in let pair = fun a -> fun b -> fun k -> k a b in let fst = fun p -> p (fun a -> fun b -> a) in let snd = fun p -> p (fun a -> fun b -> b) in let mk = fun t -> fun p -> fun ip -> pair t (pair p ip) in let tape0 = fun i -> 0 in let get = fun t -> fun p -> t p in let set = fun t -> fun p -> fun v -> fun i -> if i = p then v else t i in let runbf = fun prog -> let seek_fwd = fix (fun self -> fun ip -> fun depth -> let op = prog ip in if op = 0 then ip else if op = 7 then self (ip+1) (depth+1) else if op = 8 then if depth = 0 then ip else self (ip+1) (depth-1) else self (ip+1) depth) in let seek_bwd = fix (fun self -> fun ip -> fun depth -> let op = prog ip in if op = 0 then ip else if op = 8 then self (ip-1) (depth+1) else if op = 7 then if depth = 0 then ip else self (ip-1) (depth-1) else self (ip-1) depth) in let step = fix (fun self -> fun state -> let t = fst state in let p = fst (snd state) in let ip = snd (snd state) in let op = prog ip in if op = 0 then state else if op = 1 then self (mk t (p+1) (ip+1)) else if op = 2 then self (mk t (p-1) (ip+1)) else if op = 3 then let cell = get t p in let t2 = set t p (cell+1) in self (mk t2 p (ip+1)) else if op = 4 then let cell = get t p in let t2 = set t p (cell-1) in self (mk t2 p (ip+1)) else if op = 5 then let cell = get t p in let _ = prInt cell in self (mk t p (ip+1)) else if op = 6 then let t2 = set t p 0 in self (mk t2 p (ip+1)) else if op = 7 then let cell = get t p in if cell = 0 then let j = seek_fwd (ip+1) 0 in self (mk t p (j+1)) else self (mk t p (ip+1)) else if op = 8 then let cell = get t p in if cell = 0 then self (mk t p (ip+1)) else let j = seek_bwd (ip-1) 0 in self (mk t p (j+1)) else self (mk t p (ip+1))) in step (mk tape0 0 0) in  let prog = fun i -> if i = 0 then 3 else if i = 1 then 3 else if i = 2 then 7 else if i = 3 then 1 else if i = 4 then 3 else if i = 5 then 3 else if i = 6 then 3 else if i = 7 then 2 else if i = 8 then 4 else if i = 9 then 8 else if i = 10 then 1 else if i = 11 then 5 else 0 in runbf prog
